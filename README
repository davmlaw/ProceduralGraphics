Code for http://proceduralgraphics.blogspot.com/